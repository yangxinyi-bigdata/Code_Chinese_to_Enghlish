## 20240922

Electron, 目前打算用这个开发, 等于说出浏览器套壳.

需要技术: Node.js安装Electron
Vue
Flask

这几部分, 我需要先搞哪个呢? 
回忆一下原来的那个是怎么搞的吧.


这个正符合我的需求, 
使用Vue, 进行网站开发.
然后网站使用API, 前后端分离的技术, 
使用Flask, 开发一系列的视图API, 然后将我的python代码, 作为系统层, 和视图API对接上.
然后在前端通过vue访问python后端的视图API, 变成一个网站.

再利用Electron, 本地启动浏览器, 封装成一个软件.
这样就完成了.

Node.js 

流程总结：

	•	Flask -> 提供后端API。
	•	Vue.js -> 开发前端页面，通过HTTP请求与Flask API交互。
	•	Electron -> 将前端打包成桌面应用，同时在Electron中启动Flask作为后端服务。

重新思考: 我似乎可以直接使用Jinjia2进行开发, 不需要用到前后端分离, 这样技术难度应该会大幅度下降.

所以考虑用Jinjia进行开发吗? 
所以我需要一个前端的页面, 这个前端的页面应该是什么样的呢? 

前端名称:
CodeTranslateWeb

### 20240929
接下来应该要搞什么了? 

1. 首先翻译功能还很不完善, 应该进行错误排查, 确保翻译的结果可用
2. Rope翻译速度太慢了, 应该用Rope提取变量, 然后根据变量类型, 有一些简单的变量就直接使用文本替换方法即可.
3. 中译英的功能, 之前替换思路和英译中差别很大, 要多测试一下, 看看需不需要也改成和英译中类似的功能.
4. 对Python软件进行封装测试, 封装之后再和Electron一块进行封装.

那么今天搞哪部分呢? 
Python软件打包, 就这个了.


### 20241005

看起来真的已经完成了很多东西了.
不是我想象的那么少, 看一看之前的规划, 到了这一步已经几乎都完成了.

项目已经到了收尾的程度了, 不要着急, 国庆假期能把基本功能完成, 软件能运行起来, 正常翻译就可以.
至于其他的可以慢慢来.

现在想一下, 还有哪些东西是需要做的.

中译英: 

1. 这个目前翻译文件夹层级逻辑上回测试还有BUG.
2. 使用Rope进行中译英的翻译
3. 单个Py代码和单个Jupyter代码的翻译.
4. 大量测试, 但是我还没有很多中文项目, 可以先用英文翻译成中文, 然后再翻译回去.

英译中:
1. 单个py代码翻译
2. 单个jupyter文件翻译
3. 直接翻译在当前项目当中
4. 不全部用Rope的翻译功能, 用Rope的提取变量功能, 然后判断变量的来源, 如果是在当前代码中定义的, 就直接翻译.
如果是项目内引入的变量, 就翻译成相同调度结果. 从而加快翻译速度.

那么今天要完成哪部分任务呢? 
- [x] 翻译单个py代码, 使用Rope慢速翻译

今天完成这两个吧.
首先翻译单个py代码, 这个思路是什么, 首先我要先看看原来搞了哪些东西.
这个翻译, 填入文件路径, 然后在同文件夹下面生成一个翻译文件.

单个py文件翻译: 
如果有其他的代码在引用这个代码, 那么岂不是会导致其他的代码会无法运行? 
所以其实并不好, 如果要重构, 还是应该重构整个项目才对.
哦不对, 我是要生成一个新的代码对吧, 不会覆盖原来的, 这样文件名称也变化了, 
所以并不会出现这种问题, 

1. 对当前文件进行复制, 重命名成对应的中文名称.
2. 使用Rope提取变量? 这样import进来的变量会出现吗, 我过滤掉import变量, 这样就有了变量.
3. 使用Rope重新创建资源, 然后对这个变量进行重命名? 或者是我自己对变量进行重命名.

知识: Rope重构不会影响其他模块方式: 
# in_hierarchy 参数的作用是当重命名一个方法时，决定是否在类的继承层次结构中重命名所有匹配的方法，而不是限制重构的范围到当前模块。
changes = refactoring.get_changes(new_name=var['new_name'], in_hierarchy=False)


# 获取重构所需的更改，指定 resources 参数为当前文件
        changes = refactoring.get_changes(
            new_name=var['new_name'],
            resources=[resource],
        )

现在我应该做的是, 用Rope创建项目和资源, 然后在重命名的时候, 确保不会影响到其他的文件就可以.

/Users/yangxinyi/Downloads/200_临时文件夹/english_test_project/app.py

把这个路径传进去, 然后项目路径就是上层文件夹.

### 20241007

- [ ] 翻译单个jupyter代码, 不翻译关联变量
ok, 今天的目标比较小, 把jupyter文件翻译搞完就可以, 这个以前已经弄过了, 应该是比较简单.
找一找相关代码在哪里? 

原来的思路找到了, 

def 代码文件翻译_V2
判断如何是ipynb文件, 则使用函数将其转换成Py代码.
然后再用提取变量的方法, 从中提取出变量.

然后再对每一个cell中代码进行遍历, 对代码进行替换, 所以就是多替换几次而已.
这样如果使用Rope进行替换的话, 存在一些问题, Rope是将整个代码进行重构.
而jupyter是用json进行保存的. 无法进行重构. 所以我需要手动替换, 那么还是提取出来变量以后(这个简单, 可以用Rope)
遍历单元格中的代码, 对每个代码, 都对所有变量进行替换? 

但是中文的之前已经替换过了, 对于英文应该如何进行替换呢? 
jupyter的变量替换不可能使用Rope, 只能是自己进行手动替换.
有了变量和翻译变量.

尝试使用: 函数_替换代码变量
```    
elif 代码类型 == "ipynb":
        for cell in notebook['cells']:
            if cell['cell_type'] == 'code':
                source = ''.join(cell['source'])
                翻译代码 = 函数_替换代码变量(source, 中文变量映射)
                if isinstance(source, list):
                    cell['source'] = 翻译代码.splitlines(keepends=True)
                elif isinstance(source, str):
                    cell['source'] = 翻译代码
```

今天 = datetime.datetime.今天()
对于代码中的today变量, 也给进行了替换, 出现问题.
我应该替换的是我自己定义的变量, 但是现在出现了这个问题, 怎么办呢?
中文的时候还好,  因为别人原来的代码中没有中文出现, 我可以进行替换, 但是现在这样确实没办法.

today = datetime.datetime.today()

这种替换的时候, 我只希望替换自己定义的变量, 不喜欢批量替换.
这个还真是不好解决啊.

```python
class A:
    def __init__(self, today):
        self.today = today

a = A()
today = a.today
```
如果是我自己在代码中定义的则可以, 如果是从外部引入的, 则不行.
使用Rope可以很容易的进行判断, 但是我自己的代码, 如何区分.
如果是所有 a.today 点后面的都不进行替换?

**本次开发思路记录**
在jupyter中翻译, 现在有两个思路, 第一个是对每一个cell中的代码, 都创建成一个py文件, 然后用rope进行重命名.
第二个是将source部分都提取出来, 合并成一个python文件, 但是打上标记, 使之可以合并回原来的source的json当中去.
然后使用一个Rope批量替换掉, 再重新处理合并回去.

Rode学习.ipynb中代码
project = rope.base.project.Project(临时目录)
后面是临时项目创建方法.

还是打标记然后重新合并回去的方法似乎更合理, 下次有时间就这样搞.


### 20241009
- [ ] jupyter代码转换成py代码, 再转换回来

思路是在每个代码块上面添加一个 # 注释的标记项目.
然后再处理完成之后, 再按照原样还原回原来的jupyter的json格式中.

### 20241115
时隔一个月之后的回归! 
争取一天找到一个小时的时间去进行完善.
水磨的功夫, 慢慢完善这个项目吧! 努力, 杨心一.

现在的思路是什么呢? 

### 20241117

所以现在应该干什么呢? 
现在软件应该是已经能够正常打开了, 打包应该也没问题.
那么现在我就专心让软件可以有效的工作吧!

一共六个功能, 我就一个一个的做大量的测试, 保证软件能够正常的翻译代码, 不会破坏原有的功能.

我好像记得, Rope翻译虽然慢, 但是功能是正常的. 我原来的翻译方案似乎不太行, 会有问题, 要不就先用Rope吧.
有点记不清细节了, 但是应该是用Rope直接翻译会更好.

今天的目标是先对整体项目翻译进行处理, 我记得还有BUG, 英文翻译中文.
中文翻译英文.

- [ ] 前端页面先提交一个版本的git, 后端页面也提交一个版本的git
- [ ] 老版本的英译中和英译中前端页面没必要保留了, 直接删除吧
- [ ] 详细测试英文代码翻译中文中的BUG, 并逐一进行修复.

其他目标

- [ ] 详细测试英文单个代码翻译, 并修复BUG
- [ ] 详细测试





